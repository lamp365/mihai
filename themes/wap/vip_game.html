<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <title>免费抽大奖</title>
    <link href="__RESOURCE__/recouse/css/bjcommon.css" rel="stylesheet" type="text/css" />
    <link href="__RESOURCE__/recouse/css/bjdetail.css" rel="stylesheet" type="text/css" />
    <link href="__RESOURCE__/recouse/css/iclub.css" rel="stylesheet" type="text/css" />
    <link type="text/css" rel="stylesheet" href="<?php echo RESOURCE_ROOT;?>addons/common/beAlert/css/BeAlert.css" />
    <link type="text/css" rel="stylesheet" href="<!--@php echo RESOURCE_ROOT;@-->addons/common/fontawesome3/css/font-awesome.min.css" />
    <script type="text/javascript"  src="__RESOURCE__/recouse/js/jquery-1.10.2.min.js"></script>
</head>

<body class="task-list-wrap " style="min-width: 320px;max-width: 640px;margin:0 auto;">
    <div class="top_header">
        <div class="header_left">
            <a href="javascript:;" class="return" style="margin-top: 4px;"><img src="__RESOURCE__/openshop/images/return.png"  height="18px"></a>
        </div>
        <div class="header_title">
            免费抽大奖
        </div>
    </div>
    <div class="vip_game_banner">
        <img src="__RESOURCE__/recouse/images/vip_game_banner.jpg">
    </div>
    <div class="game-paly">
        <div class="ly-plate">
            <div class="rotate-bg"><img src="__RESOURCE__/recouse/images/ly-plate.png"></div>
            <div class="lottery-star"><img src="__RESOURCE__/recouse/images/rotate-static.png" id="lotteryBtn"></div>
        </div>
    </div>
    <div class="winning-list">
        <div class="look-my-winning">点击查看我的中奖纪录</div>
        <div class="winning-list-div">
            <p>-中奖榜单-</p>
            <div class="winning-list-div-1">
                <ul class="winning-list-ul">
                    <li class="clearfix">
                        <div class="winning-list-ul-left">13400786077</div>
                        <div class="winning-list-ul-right">10元优惠券</div>
                    </li>
                    <li class="clearfix">
                        <div class="winning-list-ul-left">13400786077</div>
                        <div class="winning-list-ul-right">20元优惠券</div>
                    </li>
                    <li class="clearfix">
                        <div class="winning-list-ul-left">13400786077</div>
                        <div class="winning-list-ul-right">30元优惠券</div>
                    </li>
                    <li class="clearfix">
                        <div class="winning-list-ul-left">13400786077</div>
                        <div class="winning-list-ul-right">40元优惠券</div>
                    </li>
                    <li class="clearfix">
                        <div class="winning-list-ul-left">13400786077</div>
                        <div class="winning-list-ul-right">50元优惠券</div>
                    </li>
                    <li class="clearfix">
                        <div class="winning-list-ul-left">13400786077</div>
                        <div class="winning-list-ul-right">60元优惠券</div>
                    </li>
                    <li class="clearfix">
                        <div class="winning-list-ul-left">13400786077</div>
                        <div class="winning-list-ul-right">70元优惠券</div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="game-rule">
        <p>-活动规则-</p>
        <ol>
            <li>活动规则活动规则活动规则活动规则</li>
            <li>活动规则活动规则活动规则活动规则活动规则活动规则活动规则</li>
            <li>活动规则活动规则活动规则活动规则活动规则</li>
        </ol>
    </div>
    <!--@php include themePage('footer');@-->
</body>

<script type="text/javascript" src="<?php echo RESOURCE_ROOT;?>addons/common/beAlert/js/beAlert.js"></script>
<script type="text/javascript" src="__RESOURCE__/recouse/js/jQueryRotate.2.2.js"></script>
<script>
$(function(){
    //后退按钮
    $(".return").click(function(){
        var refer = document.referrer;//没有来源url
        if(refer.length == 0){
            var url = "index.php";
            window.location.href = url;
        }else{
            window.history.back(-1);
        }
    });
    var timeOut = function(){  //超时函数
        $("#lotteryBtn").rotate({
            angle:0, 
            duration: 10000, 
            animateTo: 2160, //这里是设置请求超时后返回的角度，所以应该还是回到最原始的位置，2160是因为我要让它转6圈，就是360*6得来的
            callback:function(){
                alert('网络超时')
            }
        }); 
    }; 
    var rotateFunc = function(awards,angle,text){  //awards:奖项，angle:奖项对应的角度
        $('#lotteryBtn').stopRotate();
        $("#lotteryBtn").rotate({
            angle:0, 
            duration: 5000, 
            animateTo: angle+1440, //angle是图片上各奖项对应的角度，1440是我要让指针旋转4圈。所以最后的结束的角度就是这样子^^
            callback:function(){
                alert(text)
            }
        }); 
    };
    
    $("#lotteryBtn").rotate({ 
       bind: 
         { 
            click: function(){
                var time = [0,1];//1代表有中奖，0代表未中奖
                    time = time[Math.floor(Math.random()*time.length)];//服务端设置中奖的概率。服务端传的值是data数组的索引值
                if(time==0){
                    timeOut(); //网络超时
                }
                if(time==1){
                    var data = [1,2,3,0]; //返回的数组，1,2,3,0分别对应一等奖，二等奖，三等奖和没中奖
                        data = data[Math.floor(Math.random()*data.length)];//服务端设置中奖值。服务端传的值是data数组的索引值
                    if(data==1){
                        //157是一等奖对应的角度
                        rotateFunc(1,157,'恭喜您抽中的一等奖')
                    }
                    if(data==2){
                        //247是二等奖对应的角度
                        rotateFunc(2,247,'恭喜您抽中的二等奖')
                    }
                    if(data==3){
                        //22是三等奖对应的角度
                        rotateFunc(3,22,'恭喜您抽中的三等奖')
                    }
                    if(data==0){
                        var angle = [67,112,202,292,337];
                            angle = angle[Math.floor(Math.random()*angle.length)]
                        rotateFunc(0,angle,'很遗憾，这次您未抽中奖')
                    }
                }
            }
         } 
       
    });
    var listPanel = $('.winning-list-ul');
        var z = 0;//向上滚动top值
        function up() {//向上滚动
            listPanel.animate({//中奖结果
                'margin-top': (z - 35) + 'px'
            }, 3000, 'linear', function () {
                listPanel.css({'margin-top': '0px'})
                .find("li:first").appendTo(listPanel);
                up();
            });
        }
        up();
})
</script>
</html>
